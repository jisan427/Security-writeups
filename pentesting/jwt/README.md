         JWT Vulnerabilities тАУ PortSwigger

ЁЯза JWT (JSON Web Token) 
рж▓рзНржпрж╛ржм рж╢рзБрж░рзБ ржХрж░рж╛рж░ ржЖржЧрзЗ ржЖржорж┐ JWT рж╕ржорзНржкрж░рзНржХрзЗ ржкрж░рж┐рж╖рзНржХрж╛рж░ ржзрж╛рж░ржгрж╛ ржирж┐рж▓рж╛ржоред JWT ржорзВрж▓ржд stateless authentication-ржПрж░ ржЬржирзНржп ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯред ржПржЦрж╛ржирзЗ server ржЖрж▓рж╛ржжрж╛ ржХрж░рзЗ session store ржХрж░рзЗ ржирж╛; ржмрж░ржВ ржПржХржЯрж┐ signed token ржХрзНрж▓рж╛рзЯрзЗржирзНржЯржХрзЗ ржжрж┐рзЯрзЗ ржжрзЗрзЯред ржкрж░рзЗрж░ ржкрзНрж░рждрж┐ржЯрж╛ request-ржП ржУржЗ token ржкрж╛ржарж╛ржирзЛ рж╣рзЯред

JWT рж╕рж╛ржзрж╛рж░ржгржд рждрж┐ржиржЯрж┐ ржЕржВрж╢рзЗ ржмрж┐ржнржХрзНржд ржерж╛ржХрзЗ:

1я╕ПтГг Header
ржПржЦрж╛ржирзЗ token ржХрзЛржи algorithm ржжрж┐рзЯрзЗ sign ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ рж╕рзЗржЯрж╛ ржерж╛ржХрзЗ (alg)тАФржпрзЗржоржи HS256 ржмрж╛ RS256ред

2я╕ПтГг Payload
ржПржЦрж╛ржирзЗ ржерж╛ржХрзЗ userтАСrelated рждржерзНржптАФusername, userId, role, isAdmin ржЗрждрзНржпрж╛ржжрж┐ред ржПржЗ ржЕржВрж╢ржЯрж╛ржЗ рж╕рж╛ржзрж╛рж░ржгржд attacker ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ ржЪрж╛рзЯред

3я╕ПтГг Signature
Header + Payload ржПржмржВ ржПржХржЯрж┐ secret / private key ржжрж┐рзЯрзЗ signature рждрзИрж░рж┐ ржХрж░рж╛ рж╣рзЯред Server ржПржЗ signature verify ржХрж░рзЗ ржирж┐рж╢рзНржЪрж┐ржд рж╣рзЯ ржпрзЗ token ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж╛ рж╣рзЯржирж┐ред

рж╕ржорж╕рзНржпрж╛ рждржЦржиржЗ рж╢рзБрж░рзБ рж╣рзЯ, ржпржЦржи server ржПржЗ verification process ржнрзБрж▓ржнрж╛ржмрзЗ implement ржХрж░рзЗред PortSwigger-ржПрж░ ржПржЗ рж▓рзНржпрж╛ржмржЧрзБрж▓рзЛ ржорзВрж▓ржд рж╕рзЗржЗ ржнрзБрж▓ implementation-ржЧрзБрж▓рзЛржЗ рж╣рж╛рждрзЗтАСржХрж▓ржорзЗ ржжрзЗржЦрж╛рзЯред


     Lab 1: JWT authentication bypass via unverified signature

ржЖржорж┐ ржкрзНрж░ржержорзЗ normal user ржжрж┐рзЯрзЗ login ржХрж░рж▓рж╛ржоред Burp Suite-ржП proxy ржЕржи ржХрж░рзЗ request/response observe ржХрж░рж▓рж╛ржоред Login response-ржП ржПржХржЯрж╛ JWT token ржкрзЗрж▓рж╛ржоред Token decode ржХрж░рзЗ ржжрзЗржЦрж┐ payload-ржП ржЖржорж╛рж░ username ржкрж░рж┐рж╖рзНржХрж╛рж░ржнрж╛ржмрзЗ рж▓рзЗржЦрж╛ред

ржПржЦрж╛ржирзЗржЗ ржЖржорж╛рж░ ржорж╛ржерж╛рзЯ ржкрзНрж░рж╢рзНржи ржПрж▓рзЛтАФ

тАЬржПржЗ token ржХрж┐ рж╕рждрзНржпрж┐ржЗ server signature verify ржХрж░ржЫрзЗ?тАЭ
ЁЯЫа What I tested
ржЖржорж┐ payload modify ржХрж░рзЗ ржжрзЗржЦрж┐ server ржХрзА react ржХрж░рзЗ:

username / role ржлрж┐рж▓рзНржб ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзЗ administrator ржХрж░рзЗ ржжрж┐рж▓рж╛ржо
Signature ржЕржВрж╢рзЗ ржХрзЛржирзЛ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж▓рж╛ржо ржирж╛
ЁЯУМ Result & observation
Token ржкрж╛ржарж╛ржирзЛрж░ ржкрж░ server ржХрзЛржирзЛ error ржжрж┐рж▓ ржирж╛ред ржмрж░ржВ adminтАСonly endpoint ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХрж░рждрзЗ ржкрж╛рж░рж▓рж╛ржоред

Deleted carlos user  & Lab Solved

Lab 2: JWT authentication bypass via flawed signature verification 

ржПржмрж╛рж░ token header ржнрж╛рж▓рзЛ ржХрж░рзЗ inspect ржХрж░рж▓рж╛ржоред рж╕рзЗржЦрж╛ржирзЗ alg parameter ржЖржЫрзЗред ржЕржирзЗржХ application ржнрзБрж▓ржнрж╛ржмрзЗ clientтАСprovided alg value trust ржХрж░рзЗред

ржЖржорж┐ header modify ржХрж░рзЗ:

alg ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзЗ None ржХрж░рж▓рж╛ржо
Signature ржкрзБрж░рзЛржкрзБрж░рж┐ remove ржХрж░рж▓рж╛ржо
Payload-ржП admin role рж╕рзЗржЯ ржХрж░рж▓рж╛ржо

Server ржЖржмрж╛рж░ token accept ржХрж░рж▓ ржПржмржВ authentication bypass рж╣рзЯрзЗ ржЧрзЗрж▓ред

Deleted carlos user & Lab Solved
