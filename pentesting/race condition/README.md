
    Race Condition Vulnerabilities 


Lab 1: Basic Race Condition in Business Logic


ЁЯФО Vulnerability Analysis
ржЕрзНржпрж╛ржкрзНрж▓рж┐ржХрзЗрж╢ржи ржПржХрж╛ржзрж┐ржХ рж╕ржорж╕рж╛ржорзЯрж┐ржХ (concurrent) request ржкрзНрж░ржХрзНрж░рж┐рзЯрж╛ржХрж░ржгрзЗрж░ рж╕ржорзЯ shared state рж╕ржарж┐ржХржнрж╛ржмрзЗ lock ржХрж░рзЗ ржирж╛ред ржлрж▓рзЗ ржПржХржЗ logical check ржПржХрж╛ржзрж┐ржХржмрж╛рж░ ржкрж╛рж╢ ржХрж░рзЗ ржпрж╛рзЯред

ЁЯзк Abuse Scenario
ржПржХржЗ ржЕржкрж╛рж░рзЗрж╢ржи ржПржХрж╕рж╛ржерзЗ ржПржХрж╛ржзрж┐ржХржмрж╛рж░ ржЯрзНрж░рж┐ржЧрж╛рж░ рж╣рж▓рзЗ server state ржЕрж╕рж╛ржоржЮрзНржЬрж╕рзНржпржкрзВрж░рзНржг рж╣рзЯрзЗ ржкрзЬрзЗред

ЁЯОп Impact

Duplicate action execution
Financial ржмрж╛ logical inconsistency
ЁЯЫбя╕П Mitigation

Atomic operations ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рж╛
Critical sectionтАСржП serverтАСside locking

Lab 2: Race Condition in Balance / Limit Check
ЁЯФм Lab Focus: CheckтАСthenтАСuse flaw

ЁЯФО Vulnerability Analysis
Server ржкрзНрж░ржержорзЗ balance ржмрж╛ limit ржпрж╛ржЪрж╛ржЗ ржХрж░рзЗ, ржПрж░ржкрж░ ржЖрж▓рж╛ржжрж╛ ржзрж╛ржкрзЗ state ржЖржкржбрзЗржЯ ржХрж░рзЗред Concurrent requestтАСржПрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ ржПржЗ ржжрзБржЗ ржзрж╛ржкрзЗрж░ ржоржзрзНржпрзЗ race рждрзИрж░рж┐ рж╣рзЯред

ЁЯзк Abuse Scenario
ржПржХрж╛ржзрж┐ржХ ржЕржирзБрж░рзЛржз ржПржХржЗ рж╕ржорзЯрзЗ ржкрж╛ржарж╛рж▓рзЗ balance check ржПржХрж╛ржзрж┐ржХржмрж╛рж░ рж╕ржлрж▓ рж╣рзЯред

ЁЯОп Impact

Double spending
Credit abuse
ЁЯЫбя╕П Mitigation

Single atomic transaction ржмрзНржпржмрж╣рж╛рж░
DatabaseтАСlevel constraints ржкрзНрж░рзЯрзЛржЧ

Lab 3: Race Condition in Coupon / Discount Application
ЁЯФм Lab Focus: OneтАСtime token reuse

ЁЯФО Vulnerability Analysis
ржПржХржмрж╛рж░ ржмрзНржпржмрж╣рж╛рж░ржпрзЛржЧрзНржп coupon ржмрж╛ discount code invalidate ржХрж░рж╛рж░ ржЖржЧрзЗ ржПржХрж╛ржзрж┐ржХ request ржЧрзНрж░рж╣ржг ржХрж░рж╛ рж╣рзЯред

ЁЯзк Abuse Scenario
ржПржХржЗ coupon ржПржХржЗ рж╕ржорзЯрзЗ ржПржХрж╛ржзрж┐ржХржмрж╛рж░ ржкрзНрж░рзЯрзЛржЧ ржХрж░рж╛ рж╕ржорзНржнржм рж╣рзЯред

ЁЯОп Impact

Revenue loss
Business rule bypass
ЁЯЫбя╕П Mitigation

Coupon redemptionтАСржП strict locking
ServerтАСside idempotency enforcement

Lab 4: Race Condition in Inventory / Stock Management
ЁЯФм Lab Focus: Concurrent stock update

ЁЯФО Vulnerability Analysis
Inventory count ржХржорж╛ржирзЛрж░ ржЖржЧрзЗ availability ржпрж╛ржЪрж╛ржЗ ржХрж░рж╛ рж╣рзЯ, ржХрж┐ржирзНрждрзБ concurrent update рж╕ржарж┐ржХржнрж╛ржмрзЗ sync ржХрж░рж╛ рж╣рзЯ ржирж╛ред

ЁЯзк Abuse Scenario
ржПржХржЗ ржкржгрзНржп рж╕рзАржорж┐ржд рж╕рзНржЯржХ ржерж╛ржХрж╛ рж╕рждрзНрждрзНржмрзЗржУ ржПржХрж╛ржзрж┐ржХржмрж╛рж░ рж╕ржлрж▓ржнрж╛ржмрзЗ ржЕрж░рзНржбрж╛рж░ рж╣рзЯред

ЁЯОп Impact

Overselling
Inventory inconsistency
ЁЯЫбя╕П Mitigation

Transaction isolation level ржмрзГржжрзНржзрж┐
RowтАСlevel locking ржкрзНрж░рзЯрзЛржЧ

Lab 5: Race Condition in Account State Change
ЁЯФм Lab Focus: State transition race

ЁЯФО Vulnerability Analysis
Account status ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ рж╕ржорзЯ (ржпрзЗржоржи: upgrade, verification) ржПржХрж╛ржзрж┐ржХ concurrent request ржЧрзНрж░рж╣ржг ржХрж░рж╛ рж╣рзЯред

ЁЯзк Abuse Scenario
ржПржХржЗ state transition ржПржХрж╛ржзрж┐ржХржмрж╛рж░ ржХрж╛рж░рзНржпржХрж░ рж╣рзЯрзЗ unintended privilege ржкрзНрж░ржжрж╛ржи ржХрж░рзЗред

